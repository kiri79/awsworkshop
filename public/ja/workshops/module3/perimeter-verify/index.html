<!DOCTYPE html>
<html lang="ja" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.89.2" />
    <meta name="description" content="AWS Cloud Security Virtual Event">
<meta name="author" content="Sumit Patel">

    <link rel="shortcut icon" href="https://a0.awsstatic.com/libra-css/images/site/fav/favicon.ico" type="image/ico" />
<link rel="icon" href="https://a0.awsstatic.com/libra-css/images/site/fav/favicon.ico" type="image/ico" />

    <title>4. Perimeter Layer - Verify :: AWS Security Roadshow Japan 2021</title>

    
    <link href="/css/nucleus.css" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css" rel="stylesheet">
    <link href="/css/hybrid.css" rel="stylesheet">
    <link href="/css/featherlight.min.css" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css" rel="stylesheet">
    <link href="/css/auto-complete.css" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css" rel="stylesheet">
    <link href="/css/theme.css" rel="stylesheet">
    <link href="/css/hugo-theme.css" rel="stylesheet">
    
    <link href="/css/theme-workshops.css" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
        :not(pre) > code + span.copy-to-clipboard {
            display: none;
        }
      
    </style>
    
  </head>
  <body class="" data-url="/ja/workshops/module3/perimeter-verify/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <div>
  <a href="/" title="Go home">
      <img style="vertical-align:middle" src="/images/logo.png" height="70px" />
  </a>
</div>

    </div>
    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    
    
    <li data-nav-id="/ja/agenda/" title="概要" class="dd-item
    
        
        ">
      <a href="/ja/agenda/">
          概要
          
          
            <i class="fas read-icon"></i>
          
      </a>
      
    </li>
  
 

          
          


 
  
    
    
    
    <li data-nav-id="/ja/ondemandtracks/" title="セッション資料および動画" class="dd-item
    
        
        ">
      <a href="/ja/ondemandtracks/">
          セッション資料および動画
          
          
            <i class="fas read-icon"></i>
          
      </a>
      
        <ul>
          
          
            
          
          

        
          
            
            


 
  
    
    
    
    <li data-nav-id="/ja/ondemandtracks/keynote_1/" title="基調講演１: Confidential Computing &amp; AWS" class="dd-item
    
        
        ">
      <a href="/ja/ondemandtracks/keynote_1/">
          基調講演１: Confidential Computing &amp; AWS
          
          
            <i class="fas read-icon"></i>
          
      </a>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          


 
  
    
    
    
    <li data-nav-id="/ja/workshops/" title="Workshops" class="dd-item
    parent
        
        ">
      <a href="/ja/workshops/">
          Workshops
          
          
            <i class="fas read-icon"></i>
          
      </a>
      
        <ul>
          
          
          

        
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module1/scenario/" title="1. Overview and Setup" class="dd-item ">
        <a href="/ja/workshops/module1/scenario/">
        1. Overview and Setup
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module3/scenario/" title="1. Scenario" class="dd-item ">
        <a href="/ja/workshops/module3/scenario/">
        1. Scenario
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module3/perimeter-assess/" title="2. Perimeter Layer - Assess" class="dd-item ">
        <a href="/ja/workshops/module3/perimeter-assess/">
        2. Perimeter Layer - Assess
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module3/perimeter-remediate/" title="3. Perimeter Layer - Remediate" class="dd-item ">
        <a href="/ja/workshops/module3/perimeter-remediate/">
        3. Perimeter Layer - Remediate
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module4/scenario/" title="1. Architecture" class="dd-item ">
        <a href="/ja/workshops/module4/scenario/">
        1. Architecture
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module3/perimeter-verify/" title="4. Perimeter Layer - Verify" class="dd-item active">
        <a href="/ja/workshops/module3/perimeter-verify/">
        4. Perimeter Layer - Verify
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module4/rds/" title="2. RDS with Secrets Manager" class="dd-item ">
        <a href="/ja/workshops/module4/rds/">
        2. RDS with Secrets Manager
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module3/host-assess/" title="5. Host Layer - Assess" class="dd-item ">
        <a href="/ja/workshops/module3/host-assess/">
        5. Host Layer - Assess
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module3/host-remediate/" title="6. Host Layer - Remediate" class="dd-item ">
        <a href="/ja/workshops/module3/host-remediate/">
        6. Host Layer - Remediate
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module4/fargate/" title="3. Fargate with Secrets Manager" class="dd-item ">
        <a href="/ja/workshops/module4/fargate/">
        3. Fargate with Secrets Manager
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module3/host-verify/" title="7. Host Layer - Verify" class="dd-item ">
        <a href="/ja/workshops/module3/host-verify/">
        7. Host Layer - Verify
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module1/evaluate/" title="2. Evaluate Session Manager Configuration" class="dd-item ">
        <a href="/ja/workshops/module1/evaluate/">
        2. Evaluate Session Manager Configuration
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module2/sysmgrlabsetup/" title="1. AWS Systems Manager Lab Setup" class="dd-item ">
        <a href="/ja/workshops/module2/sysmgrlabsetup/">
        1. AWS Systems Manager Lab Setup
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module1/configure/" title="3. Configure Systems Manager Session Manager" class="dd-item ">
        <a href="/ja/workshops/module1/configure/">
        3. Configure Systems Manager Session Manager
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module2/systemsmanager/" title="2. AWS Systems Manager: Operations as Code" class="dd-item ">
        <a href="/ja/workshops/module2/systemsmanager/">
        2. AWS Systems Manager: Operations as Code
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module2/inventory/" title="3. AWS Systems Manager: Inventory" class="dd-item ">
        <a href="/ja/workshops/module2/inventory/">
        3. AWS Systems Manager: Inventory
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module1/portforward/" title="4. Use Port Forwarding For Web Redirection" class="dd-item ">
        <a href="/ja/workshops/module1/portforward/">
        4. Use Port Forwarding For Web Redirection
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module2/statemgr/" title="4. AWS Systems Manager: State Manager" class="dd-item ">
        <a href="/ja/workshops/module2/statemgr/">
        4. AWS Systems Manager: State Manager
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module1/ssh/" title="5. Enable SSH Through Session Manager" class="dd-item ">
        <a href="/ja/workshops/module1/ssh/">
        5. Enable SSH Through Session Manager
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module2/patch/" title="5. AWS Systems Manager: Patch Manager" class="dd-item ">
        <a href="/ja/workshops/module2/patch/">
        5. AWS Systems Manager: Patch Manager
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module1/rdp/" title="6. Enable RDP Through Session Manager" class="dd-item ">
        <a href="/ja/workshops/module1/rdp/">
        6. Enable RDP Through Session Manager
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module2/configlabsetup/" title="6. AWS Config Lab Setup" class="dd-item ">
        <a href="/ja/workshops/module2/configlabsetup/">
        6. AWS Config Lab Setup
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module2/config/" title="7. AWS Config: Compliance as Code" class="dd-item ">
        <a href="/ja/workshops/module2/config/">
        7. AWS Config: Compliance as Code
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
        
    </ul>

    
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      

      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> 履歴削除</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <left>
    <a href="https://aws.amazon.com/privacy/?nc1=f_pr">Privacy | </a>
    <a href="https://aws.amazon.com/terms/?nc1=f_pr">Site Terms | </a>
    &copy; 2021 Amazon Web Services, Inc. or its Affiliates. All rights reserved.

</left>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/ja/'>AWS Security Roadshow Japan 2021</a> > <a href='/ja/workshops/'>Workshops</a> > 4. Perimeter Layer - Verify
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#mitigating-common-web-application-attack-vectors-using-aws-waf">Mitigating Common Web Application Attack Vectors Using AWS WAF</a></li>
      </ul>
    </li>
    <li><a href="#confirm-malicious-requests-are-blocked-by-waf-policy">Confirm malicious requests are blocked by WAF policy</a></li>
    <li><a href="#implement-waf-monitoring-dashboard-using-amazon-cloudwatch-optional">Implement WAF monitoring dashboard using Amazon CloudWatch (Optional)</a>
      <ul>
        <li><a href="#stuck-watch-this"><em>Stuck? Watch this</em></a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              4. Perimeter Layer - Verify
            </h1>
          

        


<h3 id="mitigating-common-web-application-attack-vectors-using-aws-waf">Mitigating Common Web Application Attack Vectors Using AWS WAF</h3>
<p>In the previous remediation phase, you implemented an AWS WAF ruleset to protect your site from common attack vectors. You are now going to reassess the posture of the site to confirm the rules are performing as intended and blocking the simulated malicious requests.</p>
<ol>
<li>Confirm malicious requests are blocked by WAF policy</li>
<li>Implement WAF monitoring dashboard using Amazon CloudWatch (Optional)</li>
</ol>
<h2 id="confirm-malicious-requests-are-blocked-by-waf-policy">Confirm malicious requests are blocked by WAF policy</h2>
<p>If needed, start a Session Manager connection to your Red Team Host, the scanner script can be invoked by typing the following command:</p>
<pre><code>runscanner
</code></pre>
<p>Confirm that all of the tests in the script pass. If requests (other than canary) are not being blocked, go back to the remediate phase and confirm your conditions and rules are properly configured.</p>
<p><img src="/images/final-scan-term.svg" alt="Final Scan Terminal"></p>
<p>If the the automated scanner is being used for your event (AWS sponsored), you should also see green for your unique Id <a href="https://waflabdash-ap-southeast-2.awssecworkshops.com/">on the WAF scanning results dashboard</a>.</p>
<p><img src="/images/waflabdash-post.png" alt="WAF Lab Centralized Dashboard"></p>
<h2 id="implement-waf-monitoring-dashboard-using-amazon-cloudwatch-optional">Implement WAF monitoring dashboard using Amazon CloudWatch (Optional)</h2>
<p>Use CloudWatch Dashboards to create a monitoring system for your protection layer. The following AWS article details this process: <a href="https://aws.amazon.com/blogs/aws/cloudwatch-dashboards-create-use-customized-metrics-views/">https://aws.amazon.com/blogs/aws/cloudwatch-dashboards-create-use-customized-metrics-views/</a></p>
<p>Here are some sample of metrics that you can use. Starting from top left side, in clockwise order, we have:</p>
<p><img src="/images/waf-cw-dash.png" alt="CloudWatch WAF Dashboard"></p>
<ul>
<li>
<p><strong>Allowed vs Blocked Requests</strong>: if you receive a surge in allowed access (2 times normal peak access) or blocked access (any period that identifies more than 1,000 blocked requests), you can configure CloudWatch to send an alert. The idea here is to track known DDoS (when blocked requests increase) or new version of attack (when the requests are allowed to access the system);</p>
</li>
<li>
<p><strong>BytesDownloaded vs. Uploaded</strong>: help you identify when DDoS attack targets a service that doesn't need to receive a huge amount of access in order to exhaust resources (ex: search engine component sending MBs of information for one specific request parameters set);</p>
</li>
<li>
<p><strong>ELB Spillover and Queue length</strong>: use these metrics to verify if the attack is already causing damage to the infrastructure and/or for some reason, the attacker is bypassing protection layer and attacking directly unprotected resources;</p>
</li>
<li>
<p><strong>ELB Request Count</strong>: same as above, helps you identify damage by checking if the attacker is bypassing protection layer and/or CloudFront cache; review rules to increase cache hit rate;</p>
</li>
<li>
<p><strong>ELB Healthy Host</strong>: another system health check metric;</p>
</li>
<li>
<p><strong>ASG CPU Utilization</strong>: identify if the attacker is not only bypassing the CloudFront/WAF but also the ELB layer, also use to identify the damage impact of an attack;</p>
</li>
</ul>
<hr>
<p>This concludes the Perimeter Round. You can now proceed to the You can now proceed to the <a href="../host-assess">Host Layer Round</a>.</p>
<hr>
<h3 id="stuck-watch-this"><em>Stuck? Watch this</em></h3>

<div class="notices note" ><p><em>This video has no audio</em></p>
</div>



<video width="696" height="392" controls>
  <source src="https://d1tqhetmq9f85b.cloudfront.net/downloads/lab3.4.mp4" type="video/mp4">
  Your browser doesn't support video.
</video>




<footer class="footline">
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/ja/workshops/module4/scenario/" title="1. Architecture"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/ja/workshops/module4/rds/" title="2. RDS with Secrets Manager" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js"></script>
    <script src="/js/perfect-scrollbar.min.js"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js"></script>
    <script src="/js/jquery.sticky.js"></script>
    <script src="/js/featherlight.min.js"></script>
    <script src="/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js"></script>
    <script src="/js/learn.js"></script>
    <script src="/js/hugo-learn.js"></script>

    <link href="/mermaid/mermaid.css" rel="stylesheet" />
    <script src="/mermaid/mermaid.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

