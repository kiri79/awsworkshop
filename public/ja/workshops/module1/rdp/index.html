<!DOCTYPE html>
<html lang="ja" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.89.2" />
    <meta name="description" content="AWS Cloud Security Virtual Event">
<meta name="author" content="Sumit Patel">

    <link rel="shortcut icon" href="https://a0.awsstatic.com/libra-css/images/site/fav/favicon.ico" type="image/ico" />
<link rel="icon" href="https://a0.awsstatic.com/libra-css/images/site/fav/favicon.ico" type="image/ico" />

    <title>6. Enable RDP Through Session Manager :: AWS Security Roadshow Japan 2021</title>

    
    <link href="/css/nucleus.css" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css" rel="stylesheet">
    <link href="/css/hybrid.css" rel="stylesheet">
    <link href="/css/featherlight.min.css" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css" rel="stylesheet">
    <link href="/css/auto-complete.css" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css" rel="stylesheet">
    <link href="/css/theme.css" rel="stylesheet">
    <link href="/css/hugo-theme.css" rel="stylesheet">
    
    <link href="/css/theme-workshops.css" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
        :not(pre) > code + span.copy-to-clipboard {
            display: none;
        }
      
    </style>
    
  </head>
  <body class="" data-url="/ja/workshops/module1/rdp/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <div>
  <a href="/" title="Go home">
      <img style="vertical-align:middle" src="/images/logo.png" height="70px" />
  </a>
</div>

    </div>
    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    
    
    <li data-nav-id="/ja/agenda/" title="概要" class="dd-item
    
        
        ">
      <a href="/ja/agenda/">
          概要
          
          
            <i class="fas read-icon"></i>
          
      </a>
      
    </li>
  
 

          
          


 
  
    
    
    
    <li data-nav-id="/ja/ondemandtracks/" title="セッション資料および動画" class="dd-item
    
        
        ">
      <a href="/ja/ondemandtracks/">
          セッション資料および動画
          
          
            <i class="fas read-icon"></i>
          
      </a>
      
        <ul>
          
          
            
          
          

        
          
            
            


 
  
    
    
    
    <li data-nav-id="/ja/ondemandtracks/keynote_1/" title="基調講演１: Confidential Computing &amp; AWS" class="dd-item
    
        
        ">
      <a href="/ja/ondemandtracks/keynote_1/">
          基調講演１: Confidential Computing &amp; AWS
          
          
            <i class="fas read-icon"></i>
          
      </a>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          


 
  
    
    
    
    <li data-nav-id="/ja/workshops/" title="Workshops" class="dd-item
    parent
        
        ">
      <a href="/ja/workshops/">
          Workshops
          
          
            <i class="fas read-icon"></i>
          
      </a>
      
        <ul>
          
          
          

        
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module1/scenario/" title="1. Overview and Setup" class="dd-item ">
        <a href="/ja/workshops/module1/scenario/">
        1. Overview and Setup
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module3/scenario/" title="1. Scenario" class="dd-item ">
        <a href="/ja/workshops/module3/scenario/">
        1. Scenario
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module3/perimeter-assess/" title="2. Perimeter Layer - Assess" class="dd-item ">
        <a href="/ja/workshops/module3/perimeter-assess/">
        2. Perimeter Layer - Assess
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module3/perimeter-remediate/" title="3. Perimeter Layer - Remediate" class="dd-item ">
        <a href="/ja/workshops/module3/perimeter-remediate/">
        3. Perimeter Layer - Remediate
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module4/scenario/" title="1. Architecture" class="dd-item ">
        <a href="/ja/workshops/module4/scenario/">
        1. Architecture
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module3/perimeter-verify/" title="4. Perimeter Layer - Verify" class="dd-item ">
        <a href="/ja/workshops/module3/perimeter-verify/">
        4. Perimeter Layer - Verify
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module4/rds/" title="2. RDS with Secrets Manager" class="dd-item ">
        <a href="/ja/workshops/module4/rds/">
        2. RDS with Secrets Manager
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module3/host-assess/" title="5. Host Layer - Assess" class="dd-item ">
        <a href="/ja/workshops/module3/host-assess/">
        5. Host Layer - Assess
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module3/host-remediate/" title="6. Host Layer - Remediate" class="dd-item ">
        <a href="/ja/workshops/module3/host-remediate/">
        6. Host Layer - Remediate
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module4/fargate/" title="3. Fargate with Secrets Manager" class="dd-item ">
        <a href="/ja/workshops/module4/fargate/">
        3. Fargate with Secrets Manager
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module3/host-verify/" title="7. Host Layer - Verify" class="dd-item ">
        <a href="/ja/workshops/module3/host-verify/">
        7. Host Layer - Verify
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module1/evaluate/" title="2. Evaluate Session Manager Configuration" class="dd-item ">
        <a href="/ja/workshops/module1/evaluate/">
        2. Evaluate Session Manager Configuration
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module2/sysmgrlabsetup/" title="1. AWS Systems Manager Lab Setup" class="dd-item ">
        <a href="/ja/workshops/module2/sysmgrlabsetup/">
        1. AWS Systems Manager Lab Setup
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module1/configure/" title="3. Configure Systems Manager Session Manager" class="dd-item ">
        <a href="/ja/workshops/module1/configure/">
        3. Configure Systems Manager Session Manager
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module2/systemsmanager/" title="2. AWS Systems Manager: Operations as Code" class="dd-item ">
        <a href="/ja/workshops/module2/systemsmanager/">
        2. AWS Systems Manager: Operations as Code
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module2/inventory/" title="3. AWS Systems Manager: Inventory" class="dd-item ">
        <a href="/ja/workshops/module2/inventory/">
        3. AWS Systems Manager: Inventory
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module1/portforward/" title="4. Use Port Forwarding For Web Redirection" class="dd-item ">
        <a href="/ja/workshops/module1/portforward/">
        4. Use Port Forwarding For Web Redirection
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module2/statemgr/" title="4. AWS Systems Manager: State Manager" class="dd-item ">
        <a href="/ja/workshops/module2/statemgr/">
        4. AWS Systems Manager: State Manager
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module1/ssh/" title="5. Enable SSH Through Session Manager" class="dd-item ">
        <a href="/ja/workshops/module1/ssh/">
        5. Enable SSH Through Session Manager
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module2/patch/" title="5. AWS Systems Manager: Patch Manager" class="dd-item ">
        <a href="/ja/workshops/module2/patch/">
        5. AWS Systems Manager: Patch Manager
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module1/rdp/" title="6. Enable RDP Through Session Manager" class="dd-item active">
        <a href="/ja/workshops/module1/rdp/">
        6. Enable RDP Through Session Manager
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module2/configlabsetup/" title="6. AWS Config Lab Setup" class="dd-item ">
        <a href="/ja/workshops/module2/configlabsetup/">
        6. AWS Config Lab Setup
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ja/workshops/module2/config/" title="7. AWS Config: Compliance as Code" class="dd-item ">
        <a href="/ja/workshops/module2/config/">
        7. AWS Config: Compliance as Code
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
        
    </ul>

    
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      

      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> 履歴削除</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <left>
    <a href="https://aws.amazon.com/privacy/?nc1=f_pr">Privacy | </a>
    <a href="https://aws.amazon.com/terms/?nc1=f_pr">Site Terms | </a>
    &copy; 2021 Amazon Web Services, Inc. or its Affiliates. All rights reserved.

</left>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/ja/'>AWS Security Roadshow Japan 2021</a> > <a href='/ja/workshops/'>Workshops</a> > 6. Enable RDP Through Session Manager
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#prerequisites">Prerequisites</a></li>
        <li><a href="#stuck-watch-this"><em>Stuck? Watch this</em></a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              6. Enable RDP Through Session Manager
            </h1>
          

        


<p>You can tunnel Remote Desktop Protocol (RDP) using Port Forwarding feature of Session Manager to get access to remote Windows instance. This can be achieved without opening inbound port 3389 (default RDP port) on remote instance.</p>

<div class="notices warning" ><p>You will require AWS CLI and RDP client installed on your local machine for this step and adequate access over the Internet. If you do not have required access, you may choose to skip this step.</p>
</div>

<h3 id="prerequisites">Prerequisites</h3>
<h4 id="install-and-configure-aws-cli-and-session-manager-cli-plugin-into-your-local-machine">Install and configure AWS CLI and Session Manager CLI Plugin into your local machine</h4>
<ol>
<li>
<p>Install the latest version of <a href="https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html">AWS CLI</a></p>
</li>
<li>
<p>Install the <a href="https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager-working-with-install-plugin.html">Session Manager plugin for the AWS CLI</a></p>
</li>
<li>
<p>Browse to  <a href="https://console.aws.amazon.com/iam/home?region=ap-southeast-2#/users/session-manager-demo-user?section=security_credentials">Users under the IAM console</a> and select <strong>session-manager-demo-user</strong> from the Users  <img src="/images/rdpa.png" alt=""></p>
</li>
<li>
<p>Go into the <strong>Security credentials</strong> tab and select <strong>Create access key</strong>. Note down the <strong>Access key ID</strong> and <strong>Secret Access key</strong> for step 5.  <img src="/images/rdpb.png" alt=""></p>
</li>
<li>
<p><a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-configure.html#cli-quick-configuration">Configure the AWS CLI</a> via the command below and enter your credentials with region as <strong>ap-southeast-2</strong>.</p>
<pre><code> aws configure
</code></pre>
<p><img src="/images/awsconfigexample.png" alt=""></p>
</li>
</ol>
<h4 id="install-rdp-client-on-your-local-machine">Install RDP Client on your local machine</h4>
<ol>
<li>If you do not already have the RDP Client, download and install from below
<ul>
<li>
<p>[Windows] Windows includes an RDP client by default. To verify, type <strong>mstsc</strong> at a Command Prompt window. If your computer doesn&rsquo;t recognize this command, see the <a href="https://windows.microsoft.com/">Windows home page</a> and search for the download for the Microsoft Remote Desktop app.</p>
</li>
<li>
<p>[Mac OS X] Download the Microsoft Remote Desktop app from the Mac App Store.</p>
</li>
<li>
<p>[Linux] Use <a href="https://remmina.org/">Remmina</a></p>
</li>
</ul>
</li>
</ol>
<h4 id="create-a-windows-os-user">Create a Windows OS user</h4>
<ol>
<li>
<p>Under Instances &amp; Nodes in the AWS Systems Manager navigation menu, browse to the  <a href="https://ap-southeast-2.console.aws.amazon.com/systems-manager/session-manager/start-session?region=ap-southeast-2">Session Manager console</a> and start a session to windows instance <strong>session-manager-windows-stage</strong>.</p>
</li>
<li>
<p>Type the following commands to create a new user:</p>
<ul>
<li>
<p>Input password as a secure string. Enter below command which will prompt you for a password, then type a strong password and enter:</p>
<pre><code>    $Password = Read-Host -AsSecureString
</code></pre>
</li>
<li>
<p>Create a local user:</p>
<pre><code>    New-LocalUser &quot;User01&quot; -Password $Password
</code></pre>
</li>
<li>
<p>Add user to Remote Desktop Users group:</p>
<pre><code>    Add-LocalGroupMember -Group &quot;Remote Desktop Users&quot; -Member &quot;User01&quot;
</code></pre>
</li>
</ul>
<p><img src="/images/rdp21.png" alt=""></p>
</li>
<li>
<p>Click <strong>Terminate</strong> to terminate the session or enter <strong>exit</strong> and select close.</p>
</li>
</ol>
<h4 id="rdp-to-ec2-instance">RDP to EC2 Instance</h4>
<ol>
<li>
<p>Browse to the <a href="https://ap-southeast-2.console.aws.amazon.com/ec2/home?region=ap-southeast-2#Instances:search=session-manager-windows-stage;sort=instanceId">EC2 Console</a> and note instance-id for instance <strong>session-manager-windows-stage</strong>.</p>
</li>
<li>
<p>Open a terminal on your local machine and type below command to start a session to instance <strong>session-manager-windows-stage</strong> instance.</p>
<pre><code>aws ssm start-session --target &lt;instance-id&gt; --document-name AWS-StartPortForwardingSession --parameters &quot;localPortNumber=55678,portNumber=3389&quot;
</code></pre>
</li>
<li>
<p>You should see a message indicating port <strong>55678</strong> has been opened for this session. <img src="/images/rdp1.png" alt=""></p>
</li>
<li>
<p>Open Microsoft Remote Desktop client and add a new remote desktop with below information.</p>
<ul>
<li>PC Name: <code>localhost:55678</code></li>
<li>User Account: Provide user name and password created in earlier step</li>
<li>Connection/Friendly Name: <strong>Session Manager RDP</strong> <img src="/images/rdp31.png" alt=""></li>
</ul>
</li>
<li>
<p>Using Microsoft Remote Desktop, open remote desktop connection <strong>Session Manager RDP</strong> configured earlier for localhost:55678. You should be now connected and able to work on remote instance over RDP. <img src="/images/rdp4.png" alt=""></p>
</li>
<li>
<p>Press Control+C on terminal to terminate the session. <img src="/images/rdp5.png" alt=""></p>
</li>
<li>
<p><strong>Congratulations! You have now completed this workshop!</strong></p>
</li>
</ol>
<h3 id="stuck-watch-this"><em>Stuck? Watch this</em></h3>

<div class="notices note" ><p><em>This video has no audio</em></p>
</div>



<video width="696" height="392" controls>
  <source src="https://d1tqhetmq9f85b.cloudfront.net/downloads/lab1.6.mp4" type="video/mp4">
  Your browser doesn't support video.
</video>




<footer class="footline">
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/ja/workshops/module2/patch/" title="5. AWS Systems Manager: Patch Manager"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/ja/workshops/module2/configlabsetup/" title="6. AWS Config Lab Setup" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js"></script>
    <script src="/js/perfect-scrollbar.min.js"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js"></script>
    <script src="/js/jquery.sticky.js"></script>
    <script src="/js/featherlight.min.js"></script>
    <script src="/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js"></script>
    <script src="/js/learn.js"></script>
    <script src="/js/hugo-learn.js"></script>

    <link href="/mermaid/mermaid.css" rel="stylesheet" />
    <script src="/mermaid/mermaid.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

